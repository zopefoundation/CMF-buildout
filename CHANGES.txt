CMF 1.3 beta2 (2002/07/07)

  New Features

    - Changed the modification date so that it is updated at reindex
      time and does not rely anymore on bobobase_modification_time. This
      makes export+import of objects not lose the modification date.
      Before exporting objects created with an older CMF version,
      reindex the "modified" index in the catalog (you just have to do
      it once, and only if you need to export objects).

    - Made the workflow tool compute chains using type names, as well
      as instances (Tracker #441).

    - Made the DCWorkflow worklists accept a list of formatted values
      for cataloged variable matches. The separator is a semicolon
      (Tracker #496).

    - Made the security-related indexes of the portal catalog be updated
      for all impacted objects whenever local roles are changed (Tracker
      #494). This feature makes use of the 'path' index.

    - Made 'path' (PathIndex) a standard index inside CMF. When
      upgrading from earlier versions this index will have to be created
      by hand.

    - Enabled "within day" queries for FriendlyDateCriteria E.g.,
      field="modified", value="Now", operation="within_day",
      daterange="old" -> content which was modified "today".
      (Tracker #474).

    - Made the id of the current user available to old action providers
      (DCWorkflow being a prime example) as 'user_id' (Tracker #495,
      thanks to Luca Olivetti for the patch).

    - Modified the 'standard_error_message' page template to show the
      'error_log_url', if passed in (Zope 2.6 will pass this argument
      if an error log is installed).

    - Extended the metadata tool to permit passing the type name
      directly (e.g., when building a new object, one might need to know
      the allowed subjects before construction).

    - Added a working calendar implementation to the CMFCalendar product,
      which had previously provided only an Event content type.  Thanks to
      Andy Dawkins for the work.

    - Updated FS-based skin methods to read optional '.security files,
      whcih control the role-permission mappings for each skin method.
      See CMFCore/tests/fake_skins/fake_skin/test4.py.security for an
      example.

  Bugs Fixed

    - Fixed PortalFolder's filtering so that it correctly restricts
      itself to the portal types allowed by the TypesTool (Tracker #483).

    - Fixed the TypesTool so that TypeInformation's Title is
      decorrelated from its Id (the old TypeInformation.Type() should
      not be used anymore). The Id is what gets put in the "portal_type"
      attribute of a content object, which one gets at using
      somecontent.getPortalTypeName(). The Title is returned by
      somecontent.Type(). "portal_type" is now indexed, and in most
      cases should be used when doing catalog queries instead of "Type".

    - Provided all default skins (content_hide_form, content_show_form)
      for the DCWorkflow default workflow [rev 2]. Note that, when using
      this workflow, the descriptions in the retract and reject forms
      are slightly incorrect as they mention the "private" state but in
      fact go to the "visible" state.

    - Fixed verification of portal types in the TypesTool to work in the
      presence of portal types with a non-empty title (Tracker #497).

    - Removed unintentional sharing of ActionInformation data between
      class defaults and persistent instances derived from
      ActionProviderBase.  Likewise for TypeInformation instances.

    - Enabled creation of "My Stuff" folder for users (e.g., the manager)
      authenticated "above" the normal user folder (Tracker #485, thanks
      to Dieter Maurer for the patch).

    - Fixed handling of discussion items so that they are correctly
      indexed, unindexed and reinserted into the workflows when copied
      or moved.

    - Correctly reindex the just-reset workflow variables of an object
      in a DCWorkflow after a paste.

    - Correctly insert into the workflows the objects created by a
      Scriptable Type.

    - Fixed Friendly Date Criterion edit form to correctly display the
      duration in its menu (Tracker #475, thanks to Axel Joester for the
      patch).

    - Fixed relative URL in metadata_edit_form that broke if the
      main_template had a base tag (Tracker #506).

    - Made discussion replies work correctly when hitting Enter in the
      title field (Tracker #515), and corrected discussion Preview
      followed by an Edit that lost body information (Tracker #516).

    - Fixed the deletion of replies (Tracker #513, thanks to Stefan H.
      Holek for the patch).

    - Made the Link objects deal correctly with empty remote urls
      (Tracker #507) and not strip trailing slashes (Tracker #451).

    - Made content_type_registry deal correctly with TypeInfos that have
      a title (Tracker #465, thanks to Juan Antonio Valiño García for
      the patch).

    - Changed CMFDefault.MembershipTool to not create a member folder at
      member creation time when the memberareaCreationFlag is false
      (Tracker #519). Note that any code that depended on the member
      folder being created after addMember will fail, that code should
      call createMemberarea directly if needed.

    - Fixed CMFDefault.RegistrationTool to correctly check the lack of
      'email' property when creating a new member or when checking
      member's properties validity (Tracker #508).

    - Fixed addtoFavorites to correctly add a favorite of someone else's
      document (Tracker #501).

    - Fixed CatalogTool to create a meta_type index; this is needed now
      that ZCatalog doesn't create any default indexes when
      instantiated.

    - Fixed recent_news to use 'Title' instead of 'title' to display the
      title of each news ('title' isn't indexed anymore).

    - Fixed listFolderContents to take into account its optional 'spec'
      argument.

    - Fixed index_html to correctly filter out unauthorized subfolders
      (Tracker #503).

    - Fixed exception handling to not use a string exception in
      PortalFolder (Tracker #512).

    - Changed the permission protecting the "Join" action provided by
      the default registration tool from "View" to "Add portal member"
      (Tracker #509).

    - Removed redundant "Syndication" action from SkinnedFolder; the
      SyndicationTool provides this aciton. (Tracker #481)

    - Updated INSTALL.txt to note the dependency of CMF on the TAL and
      ZTUtils packages and on the PageTemplates product for Zopes < 2.5.
      (Tracker #489).

    - Updated CatalogTool to create a Vocabulary if none present (as
      won't be for catalogs created under Zope 2.6).

    - Adapted interface checks to work with new spellings in Zope 2.6
      (older Zopes should still work).

    - Removed '##bind' headers from FSPythonScripts where they only
      repeat the defaults.

    - Corrected patterns used for "HTML body stripping" to avoid
      HTML embedded within structured text.

    - Fixed computed action of form in 'folder_rename_form' (Tracker #511;
      thanks to "yuppie" for the patch).

    - Improved cacheability of skin images by using absolute URLs.

    - Suppressed repeated load of FSImage content from filesystem
      (should only happen when in debug mode).

    - Repaired skin methods' read of '.properties' files, which hold
      additional metadata about the skin method beyond what can be
      expressed in the body.

    - Updated caching policy manager tool to use correct date format
      (RFC 1123 instead of RFC 822).
